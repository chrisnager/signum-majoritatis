<!doctype html>
<html>
    <head>
        <title>Dot</title>
        <style>
            body {
                margin: 0;
                font: 10em/1 monospace;
                white-space: nowrap;
            }
        </style>
    </head>
    <body>
        <script>
            var sequence = '+_'
            var obstacle = '^-_'

            var KeyPressHandler = {
                down(event) {
                    if (event.keyCode === 38) {
                        Player.jump()
                    } else if (event.keyCode === 40) {
                        Player.duck()
                    }
                },

                up() {
                   Player.stand()
                }
            }

            var Player = {
                jump: function() {
                    sequence = '\'' + sequence.substr(1, sequence.length)
                    render()
                },

                stand: function() {
                    sequence = '>' + sequence.substr(1, sequence.length)
                    render()
                },

                duck: function() {
                    sequence = '.' + sequence.substr(1, sequence.length)
                    render()
                },

                explode: function() {
                    sequence = '*' + sequence.substr(1, sequence.length)
                    render()
                }
            }

            var refreshObstacleInterval = setInterval(setNewObstacle, 1000)

            function setNewObstacle() {
                sequence = sequence.substr(0, sequence.length - 1) + obstacle[~~(Math.random() * 3)]
                render()
            }

            function updateSequence(n) {
                var previousObstacle = sequence[sequence.length - 1]

                sequence = sequence.substr(0, sequence.length - n) + previousObstacle + sequence.substr(n, sequence.length - 2) + sequence[sequence.length - 1]
                render()
            }

            function checkCollision() {
                if (
                    (sequence[1] === '_' && sequence[0] === '.') ||
                    (sequence[1] === '-' && sequence[0] === '>') ||
                    (sequence[1] === '^' && sequence[0] === '\'')
                ) {
                    Player.explode()
                    sequence = sequence[0] + 'Game over'
                    clearInterval(refreshObstacleInterval)
                    render()
                }
            }

            function render() {
                document.body.textContent = sequence
                console.log(sequence)
                checkCollision()
            }

            window.addEventListener('keydown', KeyPressHandler.down, true)
            window.addEventListener('keyup', KeyPressHandler.up, true)

            Player.stand()
        </script>
    </body>
</html>